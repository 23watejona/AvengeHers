<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
</head>
<body>
	<form action="javascript:void(0);" id="loginForm">
        <label for="email">Email: </label>
        <input type="email" name="email" id="email" pattern="^\w+?@purdue\.edu$" oninvalid="this.setCustomValidity('Must be a Purdue Email')" oninput="this.setCustomValidity('')"><br />
        <label for="password" >Password: </label>
        <input type="password" name="password" id="password"><br />
        <input type="submit">
    </form>
</body>
<script>
let form = document.getElementById("loginForm");
form.onsubmit = dataSubmit;

let emailInput = document.getElementById('email');
let passwordInput = document.getElementById('password');

function dataSubmit() {
    let formData = new FormData(form);
    formData.delete("password-confirm");
    let request = new XMLHttpRequest();
    request.open('POST', 'login.html', false);
    request.onload = () => {
        if (request.readyState === request.DONE) {
            if (request.status === 200) {
                document.cookie = `username=${formData.get("email")};`;
         		document.cookie = `auth=${request.responseText};`;
                document.cookie = `logged-in=true;`;
         		window.location.href = '/';
            }
        }
    }
    request.send(new URLSearchParams(new FormData(form)).toString())

}
</script>
</html>